<!DOCTYPE html>
<html>
<head>
    <title>QR Code Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#4f46e5">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/sw.js');
            });
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>Custom QR Generator</h1>
        
        <div style="display: flex; gap: 10px; margin-bottom: 20px; justify-content: center;">
            <button onclick="toggleType('url')" id="btn-url" style="padding: 10px 20px; font-size: 14px;">URL</button>
            <button onclick="toggleType('vcard')" id="btn-vcard" style="padding: 10px 20px; font-size: 14px; background: #f1f5f9; color: var(--text);">vCard</button>
            <button onclick="window.location.href='/viewer'" style="padding: 10px 20px; font-size: 14px; background: #f1f5f9; color: var(--text);">QR Viewer</button>
            <button onclick="window.location.href='/vcard-viewer'" style="padding: 10px 20px; font-size: 14px; background: #f1f5f9; color: var(--text);">vCard Viewer</button>
        </div>

        <form action="/generate" method="POST" enctype="multipart/form-data" id="qr-form">
            <input type="hidden" name="type" id="qr-type" value="url">
            
            <div id="url-fields" class="input-group">
                <span class="field-section-label">Target Destination</span>
                <input type="url" name="url" placeholder="Enter link URL (e.g. https://yourwebsite.com)" id="url-input" required>
            </div>

            <div id="vcard-fields" style="display: none;">
                <div class="input-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="grid-column: span 1;">
                        <span class="field-section-label">Identity</span>
                        <input type="text" name="first_name" placeholder="First Name">
                    </div>
                    <div style="grid-column: span 1;">
                        <span class="field-section-label">&nbsp;</span>
                        <input type="text" name="last_name" placeholder="Last Name">
                    </div>
                    
                    <div class="field-section">
                        <span class="field-section-label">Contact Numbers</span>
                        <div id="phone-container" style="display: flex; flex-direction: column; gap: 8px;">
                            <div class="dynamic-input-group">
                                <input type="tel" name="phone[]" placeholder="Mobile or Work Number">
                                <button type="button" class="add-btn" onclick="addField('phone-container', 'phone[]', 'tel', 'Additional Number')">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="field-section">
                        <span class="field-section-label">Email Addresses</span>
                        <div id="email-container" style="display: flex; flex-direction: column; gap: 8px;">
                            <div class="dynamic-input-group">
                                <input type="email" name="email[]" placeholder="Primary Email">
                                <button type="button" class="add-btn" onclick="addField('email-container', 'email[]', 'email', 'Additional Email')">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="field-section">
                        <span class="field-section-label">Professional Info</span>
                        <input type="text" name="org" placeholder="Company / Organization Name">
                    </div>
                </div>
            </div>

            <div class="options" id="qr-options">
                <div class="field-section" style="grid-column: span 2;">
                    <span class="field-section-label">Appearance & Rules</span>
                </div>
                <label>Foreground Color <input type="color" name="fg_color" value="#4f46e5"></label>
                <label>Background Color <input type="color" name="bg_color" value="#ffffff"></label>
                <label>Expiry Schedule <input type="number" name="expiry_days" min="1" placeholder="Days until expiration"></label>
                <label>Brand Logo (PNG) <input type="file" name="logo" accept="image/png"></label>
            </div>
            <button type="submit" id="submit-btn">Generate Magic QR</button>
        </form>

        <script>
            function addField(containerId, name, type, placeholder) {
                const container = document.getElementById(containerId);
                const div = document.createElement('div');
                div.className = 'dynamic-input-group';
                div.innerHTML = `
                    <input type="${type}" name="${name}" placeholder="${placeholder}">
                    <button type="button" class="remove-btn" onclick="this.parentElement.remove()">-</button>
                `;
                container.appendChild(div);
            }

            function toggleType(type) {
                document.getElementById('qr-type').value = type;
                const urlFields = document.getElementById('url-fields');
                const vcardFields = document.getElementById('vcard-fields');
                const urlInput = document.getElementById('url-input');
                const btnUrl = document.getElementById('btn-url');
                const btnVcard = document.getElementById('btn-vcard');
                const submitBtn = document.getElementById('submit-btn');
                const qrOptions = document.getElementById('qr-options');

                if (type === 'url') {
                    urlFields.style.display = 'block';
                    vcardFields.style.display = 'none';
                    qrOptions.style.display = 'grid';
                    urlInput.required = true;
                    btnUrl.style.background = 'var(--primary)';
                    btnUrl.style.color = 'white';
                    btnVcard.style.background = '#f1f5f9';
                    btnVcard.style.color = 'var(--text)';
                    submitBtn.textContent = 'Generate Magic QR';
                } else {
                    urlFields.style.display = 'none';
                    vcardFields.style.display = 'block';
                    qrOptions.style.display = 'none';
                    urlInput.required = false;
                    btnVcard.style.background = 'var(--primary)';
                    btnVcard.style.color = 'white';
                    btnUrl.style.background = '#f1f5f9';
                    btnUrl.style.color = 'var(--text)';
                    submitBtn.textContent = 'Generate vCard';
                }
            }
        </script>
        
        <div class="features-mini">
            <div class="feature-slide" style="animation-delay: 0s;">âœ¨ High Quality PNG & SVG</div>
            <div class="feature-slide" style="animation-delay: 2s;">ðŸŒ€ Animated GIF Support</div>
            <div class="feature-slide" style="animation-delay: 4s;">ðŸ“Š Real-time Scan Analytics</div>
        </div>
    </div>
</body>
</html>